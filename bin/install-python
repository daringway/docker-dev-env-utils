#!/usr/bin/env bash

# Can install multiple python versions
# But the first install will set the pyenv global
# If latest is used, will install using apt-get, faster but not

# will install latest 
ENV_PYTHON_VERSION=${1:-pkg}

if [[ "$ENV_PYTHON_VERSION" == "pkg" ]]
then
   sudo apt-get install -y python3 python3-pip
   exit $?
elif [[ "$ENV_PYTHON_VERSION" == "latest" ]]
then
   ENV_PYTHON_VERSION=3
fi

install-build-tools

TAR_FILE="Python-${ENV_PYTHON_VERSION}.tgz"

cd /tmp
wget https://www.python.org/ftp/python/${ENV_PYTHON_VERSION}/${TAR_FILE}
tar xzf ${TAR_FILE}

cd Python-${ENV_PYTHON_VERSION}
# ./configure --enable-optimizations
./configure --enable-optimizations  --exec-prefix=/usr/local

make -j 2
sudo make install

cd /usr/local/bin
if [[ -x python3 && ! -x python ]]
then
    ln -s python3 python
fi
if [[ -x pip3 && ! -x pip ]]
then
    ln -s pip3 pip
fi